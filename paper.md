---
title: 'Picht: Electron Optics in Python using the Finite Difference Method'
tags:
  - Python
  - electron optics
  - electrodynamics
  - relativistic physics
authors:
  - name: Rishiit Sharma
    orcid: 0009-0006-4895-2686
    equal-contrib: true
    affiliation: 1
affiliations:
   index: 1
 - name: None
date: 8 May 2025
bibliography: paper.bib

# Summary

Electron microscopes, focused ion beam systems, and mass spectrometers are specialized devices important to characterizing and fabricating nanotechnology. Electron optics is the field that deals with designing and shaping beams of charged particles, and relies heavily on computational methods. However, many important kinds of electrostatic lenses don't have easy analytical solutions [@hawkes_principles_1989], which increases the reliance of researchers on either experiment or simulation, when designing and understanding such systems. Numerical integration solvers are suitable for problems which require solving differential equations, and the backwards differentiation formula (BDF) is a suitable solver for use cases with potentially unstable numerical results [@Cash2015]. The package first calculates the electric field generated by the initialized electrodes or electrostatic lenses. It then calculates the particle trajectories based on the specified beam characteristics, and provides a visualization of individual particle trajectories across the specified timescale. It also fully calculates relativistic effects, and so accurately simulates particle dynamics at the keV and MeV scale, and assumes grounded boundaries, or Dirichlet boundary conditions. 

# Statement of need

'Picht' is a speedy, intuitive, and general library for electron optics. Very few non-commercial solutions exist in the field, and the existence of a tool in electron optics with enough physical realism, a low enough learning curve, and useful enough visualizations, was what gave rise to Picht. Instead of complex meshing, Picht uses a simple API with customizable sizes and shapes for cylindrical electrodes and einzel lenses, with custom voltages. Electron/ion beams can be initialized with parameterized sizes and dimensions, energies, initial divergences, and timescales of simulation. This parameterizable approach enables easy scripting of electron and ion optics, rapid prototyping of beam and lens configurations, and the ability to vary the degree of granularity of simulations. 

For example, Picht enables a 68-LOC implementation of a full [Scanning Electron Microscope](https://github.com/rolypolytoy/picht/blob/main/examples/sem.py), with full handling of beam acceleration and divergence, Wehnelt cylinders, and an electrostatic condenser and objective lens, with fully realistic crossover and focusing behavior. Picht reduces the technical expertise required to design complex systems of electron optics, and thus increases the population that can prototype and design systems meant for electron microscopy, or more broadly for nanofabrication and nano-characterization. 

# Methodology

Picht uses the Finite Difference Method to solve for the electric field- a method used at least as far back as 1989 to solve problems of this exact nature [@rouse1989three]. We use successive over-relaxation to solve systems of linear equations [@HADJIDIMOS2000177], which allows us to solve the Laplacian ∇²V = 0, followed by the electric field E = - ∇V. The package also uses Numba for speeding up the most compute-heavy operations, providing near-C speeds while remaining in the Python ecosystem and all the usability advantages that brings [@Oden2020]. 

We also, when calculating velocity, or acceleration, use relativistically-accurate formulae by computing the Lorentz factor
$$\gamma = \frac{1}{\sqrt{1 - \frac{v^2}{c^2}}}$$
At every timestep, we ensure acceleration and mass are relativistically-corrected, to ensure accurate beam trajectories even at the keV and MeV scale, to better support high-energy beams. In addition, to provide greater support for beams with high divergence, where the paraxial ray equation deviates significantly from reality, we use the Lorentz force equation for electrostatics. 

The key design principles of Picht is to provide physically accurate descriptions of electron optics that are fast-enough, and enable the visualization and analysis of beam-level phenomena. 

![SEM Beam Trajectories](https://github.com/user-attachments/assets/306c7e1e-ce28-4df8-9b98-8ca9ec437f8c)


This image generated by Picht shows the trajectory of a beam of electrons initially 15 microns wide, at a wide divergence and with a beginning energy of 10 eV, to simulate the process of thermionic emission from a tungsten (W) source [@LI2023111837]. After using realistic cathode and anode geometries with a 5kV accelerating voltage, we also add one condenser lens and one objective lens to aid in beam focusing- both einzel lenses. We can observe the diamondoid-shape generated by spherical aberration at the first crossover point, and at the second focal point, and see the demagnification of spot size, by the reduction in the scale of the diamond. 

Using an identical configurations of electrodes and einzel lenses, but with more precisely defined radial limits, we can observe the precise diameter of the spot size

[Insert Focus Image]

By hovering a mouse at the highest and lowest radial limits of the focal point and finding the difference, we can find the diameter of the focal length in meters, as well as the precise focal length. Since electrodes and lenses are generated programmatically, this means you always know precisely where the focal points are in relation to the lenses, enabling seamless transfers from designing a lens system in Picht to creating an analogous system for manufacturing.

# References
