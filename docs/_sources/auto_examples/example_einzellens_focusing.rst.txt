
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\example_einzellens_focusing.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_example_einzellens_focusing.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_example_einzellens_focusing.py:


Unipotential Lenses: Focusing
--------------------------------
Einzel lenses are three cylindrical lenses arranged in a specific pattern: the first electrode is grounded (0V), the second is at its focus_voltage, and the third is also grounded at (0V). 
They're called unipotential lenses because they can provide beam focusing and defocusing without affecting the beam's net energy, which reduces (sometimes!) the behavior we saw in cylindrical electrodes.
Always make sure the aperture_center (in grid units) aligns with the center of the r_range() when you parameterize your beam.

We'll first examine an example of an einzel lens used for focusing, which happens when the polarity of the focus_voltage is the same as the polarity of the charge-
either negative to negative, or positive to positive. We'll thus set it to -5000V, with initial electron energies at 10keV.

.. GENERATED FROM PYTHON SOURCE LINES 11-42



.. image-sg:: /auto_examples/images/sphx_glr_example_einzellens_focusing_001.png
   :alt: Electron Trajectories
   :srcset: /auto_examples/images/sphx_glr_example_einzellens_focusing_001.png
   :class: sphx-glr-single-img





.. code-block:: Python
   :lineno-start: 12


    import numpy as np
    from picht import IonOpticsSystem, ElectrodeConfig
    import matplotlib.pyplot as plt

    system = IonOpticsSystem(nr=100, nz=600, axial_size=0.6, radial_size = 0.1)


    system.add_einzel_lens(
        position=20.0,
        width=60.0,
        aperture_center=50.0,
        aperture_width=48.0,
        outer_diameter=50.0,
        focus_voltage=-5000
    )

    potential = system.solve_fields()

    trajectories = system.simulate_beam(
        energy_eV= 10000,  
        start_z=0,
        r_range=(0.0499925, 0.0500075),
        angle_range=(0, 0),
        num_particles=6,
        simulation_time=2e-9
    )

    figure = system.visualize_system(
        trajectories=trajectories)

    plt.show()

.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 3.307 seconds)


.. _sphx_glr_download_auto_examples_example_einzellens_focusing.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_einzellens_focusing.ipynb <example_einzellens_focusing.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_einzellens_focusing.py <example_einzellens_focusing.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_einzellens_focusing.zip <example_einzellens_focusing.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
